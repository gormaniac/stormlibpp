<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lookup-storm &mdash; StormLib++ Docs</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="report-ingest" href="report-ingest.html" />
    <link rel="prev" title="dnsstorm" href="dnsstorm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            stormlibpp
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stormlibpp/stormlibpp.html">StormLib++ API Docs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Power-Ups</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#installation">Installation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#power-up-docs">Power-Up Docs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="dnsstorm.html">dnsstorm</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">lookup-storm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="report-ingest.html">report-ingest</a></li>
<li class="toctree-l3"><a class="reference internal" href="stix.html">stix</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">stormlibpp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Power-Ups</a></li>
      <li class="breadcrumb-item active">lookup-storm</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/pkgs/lookup-storm.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lookup-storm">
<h1>lookup-storm<a class="headerlink" href="#lookup-storm" title="Permalink to this heading"></a></h1>
<p>Lookup common atomic indicators in Synapse as strings rather than a <code class="docutils literal notranslate"><span class="pre">&lt;form&gt;=&lt;valu&gt;</span></code> pair.</p>
<p>Not every Synapse user can, or should be expected to, know the necessary form names for common atomic indicators that analysts use. They need a way to query for these values quickly and without the form.</p>
<p>Adds a <code class="docutils literal notranslate"><span class="pre">lookup</span></code> command to a Synapse instance that accepts multiple input strings and yields Synapse nodes that have the input items as primary values. The nodes are created if they don’t already exist. The input items are used to attempt to lift nodes of the following forms, in this order, using <code class="docutils literal notranslate"><span class="pre">?=</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">hash</span><span class="p">:</span><span class="n">md5</span>
<span class="nb">hash</span><span class="p">:</span><span class="n">sha1</span>
<span class="nb">hash</span><span class="p">:</span><span class="n">sha256</span>
<span class="n">inet</span><span class="p">:</span><span class="n">cidr4</span>
<span class="n">inet</span><span class="p">:</span><span class="n">ipv4</span>
<span class="n">inet</span><span class="p">:</span><span class="n">ipv6</span>
<span class="n">inet</span><span class="p">:</span><span class="n">fqdn</span>
<span class="n">inet</span><span class="p">:</span><span class="n">email</span>
<span class="n">inet</span><span class="p">:</span><span class="n">server</span>
<span class="n">inet</span><span class="p">:</span><span class="n">url</span>
<span class="n">file</span><span class="p">:</span><span class="n">path</span>
</pre></div>
</div>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<section id="lookup-a-single-ip-address-by-string">
<h3>Lookup a single IP address by string<a class="headerlink" href="#lookup-a-single-ip-address-by-string" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lookup</span> <span class="mf">1.1.1.1</span>
</pre></div>
</div>
</section>
<section id="lookup-a-hash-an-ip-address-and-a-file-path-in-one-command">
<h3>Lookup a hash, an IP address, and a file path in one command<a class="headerlink" href="#lookup-a-hash-an-ip-address-and-a-file-path-in-one-command" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lookup</span> <span class="s2">&quot;d41d8cd98f00b204e9800998ecf8427e&quot;</span> <span class="s2">&quot;1.1.1.1&quot;</span> <span class="s2">&quot;C:\Windows\System32\calc.exe&quot;</span>
</pre></div>
</div>
</section>
<section id="lookup-a-url-and-a-tcp-server">
<h3>Lookup a url and a tcp server<a class="headerlink" href="#lookup-a-url-and-a-tcp-server" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lookup</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="n">tcp</span><span class="p">:</span><span class="o">//</span><span class="mf">1.1.1.1</span><span class="p">:</span><span class="mi">80</span>
</pre></div>
</div>
</section>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<p>Install this package in Synapse by running the following Storm command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pkg</span><span class="o">.</span><span class="n">load</span> <span class="o">--</span><span class="n">raw</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gormaniac</span><span class="o">/</span><span class="n">stormlibpp</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span><span class="n">lookup</span><span class="o">-</span><span class="n">storm</span><span class="o">/</span><span class="n">lookup</span><span class="o">-</span><span class="n">storm</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Or, build and install this package locally (assumes you’re in the root dir of the project):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>synapse.tools.genpkg<span class="w"> </span>--no-docs<span class="w"> </span>--push<span class="w"> </span><span class="s2">&quot;&lt;Cortex Telepath URL&gt;&quot;</span><span class="w"> </span>src/pkgs/lookup-storm/lookup-storm.yaml
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dnsstorm.html" class="btn btn-neutral float-left" title="dnsstorm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="report-ingest.html" class="btn btn-neutral float-right" title="report-ingest" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, John Gorman.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6G9XWTWCQG"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6G9XWTWCQG', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>